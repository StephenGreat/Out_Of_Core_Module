\section{test\-Index\-Method.\-cpp}
This an example of how to use the index method.


\begin{DoxyCodeInclude}
\textcolor{preprocessor}{#include <iostream>}
\textcolor{preprocessor}{#include <iomanip>}
\textcolor{preprocessor}{#include <algorithm>}
\textcolor{preprocessor}{#include <vector>}
\textcolor{preprocessor}{#include <boost/assert.hpp>}
\textcolor{preprocessor}{#include <string>}

\textcolor{preprocessor}{#include "../src/IndexMethod.hpp"}

\textcolor{keyword}{using namespace }std;

\textcolor{comment}{/* test the block index method, input the rows, cols, blockrows, blockcols for
       testing */}
\textcolor{keywordtype}{bool} test\_block\_index(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char} **argv)
\{
        \textcolor{keywordflow}{if}(argc < 5) \{
                cout << \textcolor{stringliteral}{"Usage : [row count] [col count] [block row size n(by
       2^n)] [block col size n(by 2^n)]"} << endl;
                \textcolor{keywordflow}{return} \textcolor{keyword}{false};
        \}

        \textcolor{keyword}{typedef} Block2DIndex::IndexType IndexType;
        \textcolor{keyword}{typedef} Block2DIndex::RowMajorIndexType RowMajorType;

        IndexType rowCount = atoi(argv[1]);
        IndexType colCount = atoi(argv[2]);
        IndexType blockRowOrderSize = atoi(argv[3]);
        IndexType blockColOrderSize = atoi(argv[4]);

        Block2DIndex blockObject(rowCount, colCount, blockRowOrderSize, 
      blockColOrderSize);

        \{
                cout << \textcolor{stringliteral}{"method one : using get\_index method : "} << endl;
                cout << \textcolor{stringliteral}{"
      *******************************************************"} << endl;
                IndexType totalSize = blockObject.get_max_index();
                \textcolor{keywordtype}{int} *vec = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[totalSize];
                std::generate(vec, vec + totalSize, []()->\textcolor{keywordtype}{int} \{
                        \textcolor{keywordflow}{return} -1;
                \});

                \textcolor{keywordflow}{for}(RowMajorType i = 0; i < rowCount; ++i) \{
                        \textcolor{keywordflow}{for}(RowMajorType j = 0; j < colCount; ++j) \{
                                vec[blockObject.get_index(i, j)] = i*colCount +
       j;
                        \}
                \}

                IndexType blockSize = blockObject.getBlockTotalSize();

                IndexType blockColSize = blockObject.getBlockColSize();
                IndexType blockIndex = 0;

                cout << \textcolor{stringliteral}{"the after block : "} << endl;
                cout << \textcolor{stringliteral}{"------------------------------------------------------
      "} << endl;
                \textcolor{keywordflow}{for}(IndexType index = 0; index < totalSize;) \{
                        cout << setw(8) << vec[index++];

                        \textcolor{comment}{//meet the end of the small block line}
                        \textcolor{keywordflow}{if}(index % blockColSize == 0) cout << endl;

                        \textcolor{keywordflow}{if}(index % blockSize == 0) cout << \textcolor{stringliteral}{"
      ------------------------------------------------------"} << endl;
                \}
                cout << endl;

                cout << \textcolor{stringliteral}{"get row major index : "} << endl;
                cout << \textcolor{stringliteral}{"------------------------------------------------------
      "} << endl;
                \textcolor{keywordflow}{for}(IndexType index = 0; index < totalSize;) \{
                        RowMajorPoint point = blockObject.get_origin_index(
      index++);
                        cout << setw(8) << \textcolor{stringliteral}{"("} << point.row << \textcolor{stringliteral}{","} << point.col
       << \textcolor{stringliteral}{")"};
                        \textcolor{keywordflow}{if}(index % blockColSize == 0) cout << endl;
                        \textcolor{keywordflow}{if}(index % blockSize == 0) cout << \textcolor{stringliteral}{"
      ------------------------------------------------------"} << endl;
                \}
                cout << endl;
        \}

        \{
                cout << \textcolor{stringliteral}{"method two : using get\_index\_by\_row\_index method : "} <
      < endl;
                cout << \textcolor{stringliteral}{"
      *******************************************************"} << endl;
                IndexType totalSize = blockObject.get_max_index();
                \textcolor{keywordtype}{int} *vec = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[totalSize];
                std::generate(vec, vec + totalSize, []()->\textcolor{keywordtype}{int} \{
                        \textcolor{keywordflow}{return} -1;
                \});

                \textcolor{keywordflow}{for}(RowMajorType i = 0; i < rowCount; ++i) \{
                        IndexType row\_result = blockObject.get_row_result(i);
                        \textcolor{keywordflow}{for}(RowMajorType j = 0; j < colCount; ++j) \{
                                vec[blockObject.get_index_by_row_result(
      row\_result, j)] = i*colCount + j;
                        \}
                \}

                IndexType blockSize = blockObject.getBlockTotalSize();

                IndexType blockColSize = blockObject.getBlockColSize();
                IndexType blockIndex = 0;

                cout << \textcolor{stringliteral}{"the after block : "} << endl;
                cout << \textcolor{stringliteral}{"------------------------------------------------------
      "} << endl;
                \textcolor{keywordflow}{for}(IndexType index = 0; index < totalSize;) \{
                        cout << setw(8) << vec[index++];

                        \textcolor{comment}{//meet the end of the small block line}
                        \textcolor{keywordflow}{if}(index % blockColSize == 0) cout << endl;

                        \textcolor{keywordflow}{if}(index % blockSize == 0) cout << \textcolor{stringliteral}{"
      ------------------------------------------------------"} << endl;
                \}
                cout << endl;

                cout << \textcolor{stringliteral}{"get row major index : "} << endl;
                cout << \textcolor{stringliteral}{"------------------------------------------------------
      "} << endl;
                \textcolor{keywordflow}{for}(IndexType index = 0; index < totalSize;) \{
                        RowMajorPoint point = blockObject.get_origin_index(
      index++);
                        cout << setw(8) << \textcolor{stringliteral}{"("} << point.row << \textcolor{stringliteral}{","} << point.col
       << \textcolor{stringliteral}{")"};
                        \textcolor{keywordflow}{if}(index % blockColSize == 0) cout << endl;
                        \textcolor{keywordflow}{if}(index % blockSize == 0) cout << \textcolor{stringliteral}{"
      ------------------------------------------------------"} << endl;
                \}
                cout << endl;
        \}
        \textcolor{keywordflow}{return} \textcolor{keyword}{true};
\}
\textcolor{keyword}{template}<\textcolor{keyword}{typename} T, \textcolor{keyword}{typename} RowMajorType>
\textcolor{keywordtype}{void} printTwoArrayVector(T array, RowMajorType row, RowMajorType col, \textcolor{keywordtype}{string} 
      arrayInfo = \textcolor{stringliteral}{""}, ostream& os = cout) \{
        os << arrayInfo << endl;
        \textcolor{keywordflow}{for}(RowMajorType i = 0; i < row; ++i) \{
                \textcolor{keywordflow}{for}(RowMajorType j = 0; j < col; ++j) \{
                        os << setw(8) << array[i*col + j];
                \}
                os << endl;
        \}
        os << endl;
\}

\textcolor{comment}{/* test zorder index, input the rows and cols for indexing */}
\textcolor{keyword}{typedef} ZOrderIndex ZOrderIndexType;
\textcolor{keywordtype}{bool} test\_zorder\_index(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char} **argv)
\{
        \textcolor{keywordflow}{if}(argc < 3) \{
                cout << \textcolor{stringliteral}{"Usage : [row] [col] "} << endl;
                \textcolor{keywordflow}{return} \textcolor{keyword}{false};
        \}

        \textcolor{keywordtype}{size\_t} row = atoi(argv[1]);
        \textcolor{keywordtype}{size\_t} col = atoi(argv[2]);

        \textcolor{comment}{//just insure the row and col are even}
        \textcolor{comment}{//BOOST\_ASSERT((row & 1) == 0 && (col & 1) == 0);}

        \textcolor{keyword}{typedef} std::vector<int> VecType;
        \textcolor{keyword}{typedef} ZOrderIndexType::IndexType IndexType;

        cout << \textcolor{stringliteral}{"method one : using get\_index method : "} << endl;
        cout << \textcolor{stringliteral}{"*******************************************************"} << 
      endl;
        \{
                \textcolor{comment}{//save the original data}
                VecType vec(row * col);
                \textcolor{keywordflow}{for}(IndexType i = 0; i < vec.size(); ++i) vec[i] = i;

                ZOrderIndexType zorder(row, col);
                \textcolor{comment}{//the after Z-order index data}
                IndexType maxIndex = zorder.get\_max\_index();
                VecType newVec(maxIndex + 1);

                IndexType result, rowResult;
                cout << \textcolor{stringliteral}{"zorder index result"} << endl;
                \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < row; ++i) \{
                        rowResult = zorder.get\_row\_result(i);
                        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < col; ++j) \{
                                result = zorder.get\_index\_by\_row\_result(
      rowResult, j);
                                cout << setw(8) << result;

                                newVec[result] = vec[i*col + j];
                        \} \textcolor{comment}{//end for of col}
                        cout << endl;
                \} \textcolor{comment}{// end for of row}

                printTwoArrayVector(newVec, row, col, \textcolor{stringliteral}{"zorder index array"});

                VecType testVec(col * row);
                \textcolor{keywordflow}{for}(IndexType i = 0; i < newVec.size(); ++i) \{
                        RowMajorPoint point = zorder.get\_origin\_index(i);
                        \textcolor{keywordtype}{size\_t} x = point.row;
                        \textcolor{keywordtype}{size\_t} y = point.col;
                        \textcolor{keywordflow}{if}(x < row && y < col) testVec[x*col + y] = newVec[i];
                \}

                printTwoArrayVector(testVec, row, col, \textcolor{stringliteral}{"get back vector"});

                \textcolor{keywordflow}{if}(std::equal(vec.begin(), vec.end(), testVec.begin()))
                        cout << \textcolor{stringliteral}{"the result is correct"} << endl;
                \textcolor{keywordflow}{else}
                        cout << \textcolor{stringliteral}{"the result is not correct"} << endl;
        \}

        cout << \textcolor{stringliteral}{"method two : using get\_index\_by\_row\_index method : "} << endl;
        cout << \textcolor{stringliteral}{"*******************************************************"} << 
      endl;
        \{
                \textcolor{comment}{//save the original data}
                VecType vec(row * col);
                \textcolor{keywordflow}{for}(IndexType i = 0; i < vec.size(); ++i) vec[i] = i;

                ZOrderIndexType zorder(row, col);
                \textcolor{comment}{//the after Z-order index data}
                IndexType maxIndex = zorder.get\_max\_index();
                VecType newVec(maxIndex + 1);

                IndexType result, rowResult;
                cout << \textcolor{stringliteral}{"zorder index result"} << endl;
                \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < row; ++i) \{
                        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < col; ++j) \{
                                result = zorder.get\_index(i, j);
                                cout << setw(8) << result;

                                newVec[result] = vec[i*col + j];
                        \} \textcolor{comment}{//end for of col}
                        cout << endl;
                \} \textcolor{comment}{// end for of row}

                printTwoArrayVector(newVec, row, col, \textcolor{stringliteral}{"zorder index array"});

                VecType testVec(col * row);
                \textcolor{keywordflow}{for}(IndexType i = 0; i < newVec.size(); ++i) \{
                        RowMajorPoint point = zorder.get\_origin\_index(i);
                        \textcolor{keywordtype}{size\_t} x = point.row;
                        \textcolor{keywordtype}{size\_t} y = point.col;
                        \textcolor{keywordflow}{if}(x < row && y < col) testVec[x*col + y] = newVec[i];
                \}

                printTwoArrayVector(testVec, row, col, \textcolor{stringliteral}{"get back vector"});

                \textcolor{keywordflow}{if}(std::equal(vec.begin(), vec.end(), testVec.begin()))
                        cout << \textcolor{stringliteral}{"the result is correct"} << endl;
                \textcolor{keywordflow}{else}
                        cout << \textcolor{stringliteral}{"the result is not correct"} << endl;
        \}

        \textcolor{keywordflow}{return} \textcolor{keyword}{true};
\}
\end{DoxyCodeInclude}
 